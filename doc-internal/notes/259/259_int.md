---

Copyright 2014 Mentor Graphics Corp.  All Rights Reserved.

---

# Take advantage of ant <parallel> during our build process
### xtUML Project Implementation Note


1. Abstract
-----------
Ant offers a tag `<parallel>` that will run tasks contained within in parallel 
rather than sequentially.  This issue implements using this feature in the bp.core
build.

2. Document References
----------------------
[1] Issues 259, https://github.com/xtuml/internal/issues/259    
[2] Issues 35, https://github.com/xtuml/internal/issues/35  
[3] https://github.com/xtuml/internal/blob/35_919690-3/doc-internal/notes/dts0100919690/Build_performance_improvement_brainstorming.md  

3. Background
-------------
The work in [2] changes our internal BridgePoint build to use a java-based
pre-builder in front of MC-Java.  It also splits the bp.core build from one 
large build chunk into four individual chunks containing different parts of the
ooaofooa model in bp.core.   

We had a brainstorming session to talk about build performance improvements and 
one of the suggestions [3, #7] was to run generator in parallel where possible.   

4. Requirements
---------------
4.1  Use the ant parallelization tag in bp.core build.  

5. Work Required
----------------
5.1  Add the `<parallel>` tag around the four-part build of ooaofooa in `bp.core/generate.xml`    
5.2  MC-Java's build target `generate-with-file_io.java` is only used by the bp.core build. 
Modify this target to run generator in a unique working directory under `gen/code_generation` 
instead of at the root of the bp.core plug-in source.  This is required so the temporary data
created by generator runs does not conflict and trample over itself.    
5.3  Add a new front-end perl script for the `generate-with-file_io.java` target to call that
creates the temporary directories as needed.    
5.4  Currently MC-Java assumes files it writes are in paths based off of the plug-in root directory. 
This is not always the case now with core builds under temporary working directories.  Thus, we must
modify the build to set the plug-in project root into the environment so MC-Java can read it out
and use it instead of assuming the working path as described previously.    

6. Implementation Comments
--------------------------
None.

7. Unit Test
------------
7.1  Since the changes are just to our internal build, the test simply assures that the build still 
works without errors.
  - Run clean all projects
  - Build `bp.core`
  - __R__ Build is successful
  - Turn on Build automatically
  - __R__ Build completes and no errors are indicated
    
8. Code Changes
---------------
Branch name: 259_parallel_gen

NOTE: This work is in conjunction with and indeed branched from 35-919690-3 and is intended to be
promoted with that branch.  The changeset here is a diff between 259_parallel_gen and that branch, _not_ master.

<pre>

com.mentor.nucleus.bp.core/generate.xml

doc-internal/process/
    HOWTO-create-new-development-workspace.md
doc-internal/process/
    HOWTO-create-new-development-workspace-Linux.md
doc-internal/process/templates/checklists/
    development-workspace-setup/EclipsePreferences.epf
doc-internal/process/templates/checklists/
    development-workspace-setup/BridgePointDev/bin/xtumlmc_gen_erate.pl
doc-internal/process/templates/checklists/
    development-workspace-setup/BridgePointDev/mc3020/bin/xtumlmc_build.exe
doc-internal/process/templates/checklists/
    development-workspace-setup/BridgePointDev-Linux/bin/xtumlmc_gen_erate.pl
doc-internal/process/templates/checklists/
    development-workspace-setup/dropins/
    com.mentor.nucleus.bp.internal.tools_1.0.3/plugin.xml (removed)
doc-internal/process/templates/checklists/
    development-workspace-setup/dropins/
    com.mentor.nucleus.bp.internal.tools_1.0.3/tools.jar (removed)
doc-internal/process/templates/checklists/
    development-workspace-setup/dropins/
    com.mentor.nucleus.bp.internal.tools_1.0.3/icons/bp_debug.gif (removed)
doc-internal/process/templates/checklists/
    development-workspace-setup/dropins/
    com.mentor.nucleus.bp.internal.tools_1.0.3/icons/green-bp.gif (removed)
doc-internal/process/templates/checklists/
    development-workspace-setup/dropins/
    com.mentor.nucleus.bp.internal.tools_1.0.3/icons/refresh.gif (removed)
doc-internal/process/templates/checklists/
    development-workspace-setup/dropins/
    com.mentor.nucleus.bp.internal.tools_1.0.6/plugin.xml
doc-internal/process/templates/checklists/
    development-workspace-setup/dropins/
    com.mentor.nucleus.bp.internal.tools_1.0.6/tools.jar
doc-internal/process/templates/checklists/
    development-workspace-setup/dropins/
    com.mentor.nucleus.bp.internal.tools_1.0.6/build_settings/build_setting.properties
doc-internal/process/templates/checklists/
    development-workspace-setup/dropins/
    com.mentor.nucleus.bp.internal.tools_1.0.6/icons/bp_debug.gif
doc-internal/process/templates/checklists/
    development-workspace-setup/dropins/
    com.mentor.nucleus.bp.internal.tools_1.0.6/icons/green-bp.gif
doc-internal/process/templates/checklists/
    development-workspace-setup/dropins/
    com.mentor.nucleus.bp.internal.tools_1.0.6/icons/refresh.gif

MC-Java/build.xml
MC-Java/enums.inc
MC-Java/java.arc
MC-Java/translate_oal.inc

</pre>

End
---

